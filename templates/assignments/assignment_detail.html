{% extends "base.html" %}
{% block content %}

<div class="dashboard">
    <div class="card">
        <h1>ğŸ“ {{ assignment.title }}</h1>

        <p class="muted">
            Course: <strong>{{ assignment.course.title }}</strong>
        </p>

        <hr />

        <p>{{ assignment.description }}</p>

        <hr />

        {# ================= STUDENT VIEW ================= #}
        {% if request.user.profile.role == request.user.profile.Role.STUDENT %}
        <h3>ğŸ“¤ Your Submission</h3>

        {% if submission %}
        <div class="card">
            <p><strong>Submitted on:</strong>
                {{ submission.submitted_at|date:"M d, Y H:i" }}
            </p>

            {% if submission.file %}
            <p>
                <a href="{{ submission.file.url }}" target="_blank">
                    ğŸ“ Download your file
                </a>
            </p>
            {% endif %}

            {% if submission.feedback %}
            <p><strong>Instructor Feedback:</strong></p>
            <p>{{ submission.feedback }}</p>
            {% endif %}

            {% if submission.grade is not None %}
            <p><strong>Grade:</strong> {{ submission.grade }}</p>
            {% endif %}
        </div>
        {% else %}
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">Submit Assignment</button>
        </form>
        {% endif %}
        {% endif %}

        {# ================= INSTRUCTOR VIEW ================= #}
        {% if request.user.profile.role == request.user.profile.Role.INSTRUCTOR %}
        <a href="{% url 'instructor_assignment_detail' assignment.id %}">
            ğŸ›  Instructor Panel
        </a>
        {% endif %}
    </div>

    <a href="{% url 'role_redirect' %}" class="btn">
        â† Back to dashboard
    </a>
</div>

{% endblock %}